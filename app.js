"use strict";var e=document.querySelector(".header__cart-sum"),t=[],a=window.sessionStorage.getItem("cart");if(null==JSON.parse(a)?e.innerHTML=0:(e.innerHTML=JSON.parse(a).length,t=JSON.parse(a)),document.querySelector(".catalog")){var n=document.querySelector(".catalog__container"),r=function(a,r){var c=document.createElement("h2");c.classList.add("catalog__title"),c.textContent=a;var s=document.createElement("ul");s.classList.add("catalog__list"),r.forEach((function(a,n){var r=document.createElement("li");r.classList.add("card","catalog__item");var c=document.createElement("div");c.classList.add("card__img-container");var i=document.createElement("img");i.classList.add("card__img"),i.setAttribute("src",a.img),i.setAttribute("alt",a.title);var d=document.createElement("div");d.classList.add("card__description");var o=document.createElement("div");o.classList.add("card__description-top");var l=document.createElement("h3");l.classList.add("card__name"),l.textContent=a.title;var p=document.createElement("div");p.classList.add("card__price");var m=document.createElement("div");if(m.classList.add("card__price-new"),m.textContent=a.price+" ₽",p.append(m),a.price_old){var u=document.createElement("div");u.classList.add("card__price-old"),u.textContent=a.price_old+" ₽",p.append(u)}var _=document.createElement("div");_.classList.add("card__description-bottom");var v=document.createElement("div");v.classList.add("card__rating");var g=document.createElement("div");g.classList.add("card__rating-star");var E=document.createElement("img");E.setAttribute("src","./images/sprite.svg#star");var L=document.createElement("span");L.textContent=a.rate;var f=document.createElement("button");f.classList.add("card__buy"),f.textContent="Купить";for(var S=0;S<t.length;S++)t[S].id===n&&(f.setAttribute("disabled",!0),f.textContent="В корзине");f.addEventListener("click",(function(r){r.preventDefault(),f.setAttribute("disabled",!0),f.textContent="В корзине",a.id=n,a.sum=1,t.push(a),window.sessionStorage.setItem("cart",JSON.stringify(t));var c=window.sessionStorage.getItem("cart");e.innerHTML=JSON.parse(c).length})),r.append(c),c.append(i),r.append(d),d.append(o),o.append(l),o.append(p),d.append(_),_.append(v),v.append(g),g.append(E),v.append(L),_.append(f),s.append(r)})),n.append(c),n.append(s)};r("Наушники",[{img:"./images/Apple_BYZ_S852I.png",title:"Apple BYZ S852I",price_old:3527,price:2927,rate:4.7},{img:"./images/Apple_EarPods.png",title:"Apple EarPods",price:2327,rate:4.5},{img:"./images/Apple_EarPods2.png",title:"Apple EarPods",price:2327,rate:4.5},{img:"./images/Apple_BYZ_S852I.png",title:"Apple BYZ S852I",price:2927,rate:4.7},{img:"./images/Apple_EarPods.png",title:"Apple EarPods",price:2327,rate:4.5},{img:"./images/Apple_EarPods2.png",title:"Apple EarPods",price:2327,rate:4.5}]),r("Беспроводные наушники",[{img:"./images/Apple_AirPods.png",title:"Apple AirPods",price:9527,rate:4.7},{img:"./images/GERLAX_GH-04.png",title:"GERLAX GH-04",price:6527,rate:4.7},{img:"./images/BOROFONE_BO4.png",title:"BOROFONE BO4",price:7527,rate:4.7}])}if(document.querySelector(".cart")){var c=document.querySelector(".cart__left"),s=document.querySelector(".cart__result-sum"),i=JSON.parse(a);if(window.sessionStorage.setItem("cart",JSON.stringify(i)),null===JSON.parse(a)||0===JSON.parse(a).length){var d=document.createElement("p");d.classList.add("cart__none"),d.textContent="Корзина пуста",c.append(d),s.textContent="0 ₽"}else{var o=function(){var e=document.querySelector(".cart__result-sum"),t=document.querySelectorAll(".cart__item-result"),a=0;t.forEach((function(e){a+=Number(e.textContent.replace("₽",""))})),e.textContent="₽ "+a};(i=i.filter((function(e){return null!=e}))).forEach((function(e,t){var a=document.createElement("li");a.classList.add("cart__item");var n=document.createElement("div");n.classList.add("cart__item-top");var r=document.createElement("img");r.classList.add("cart__img"),r.setAttribute("src",e.img),r.setAttribute("alt",e.title);var s=document.createElement("div");s.classList.add("cart__description");var d=document.createElement("p");d.classList.add("cart__item-description"),d.textContent=e.title;var l=document.createElement("span");l.classList.add("cart__item-price"),l.textContent=e.price+" ₽";var p=document.createElement("div");p.classList.add("cart__item-bottom");var m=document.createElement("div");m.classList.add("cart__item-btns");var u=document.createElement("button");u.classList.add("cart__btn-sum","cart__btn-sum--minus");var _=document.createElement("span");_.classList.add("cart__quantity"),_.textContent=e.sum;var v=document.createElement("button");v.classList.add("cart__btn-sum","cart__btn-sum--plus");var g=document.createElement("span");g.classList.add("cart__item-result"),g.textContent=e.price+" ₽";var E=document.createElement("button");E.classList.add("cart__item-del");var L=document.createElement("div");L.classList.add("cart__trash");var f=document.createElement("img");f.setAttribute("src","images/sprite.svg#trash"),u.addEventListener("click",(function(a){a.preventDefault(),e.sum<=1||(_.textContent=e.sum-1,i[t].sum=e.sum-1,window.sessionStorage.setItem("cart",JSON.stringify(i)),g.textContent=e.price*Number(_.textContent)+" ₽",o())})),v.addEventListener("click",(function(a){a.preventDefault(),_.textContent=e.sum+1,i[t].sum=e.sum+1,window.sessionStorage.setItem("cart",JSON.stringify(i)),g.textContent=e.price*Number(_.textContent)+" ₽",o()})),E.addEventListener("click",(function(e){e.preventDefault(),delete i[t],window.sessionStorage.setItem("cart",JSON.stringify(i)),a.remove(),o()})),n.append(r),n.append(s),s.append(d),s.append(l),p.append(m),m.append(u),m.append(_),m.append(v),p.append(g),E.append(L),L.append(f),a.append(n),a.append(p),a.append(E),c.append(a),o()}))}document.querySelector(".cart__submit").addEventListener("click",(function(e){e.preventDefault();var t=0,a=document.querySelectorAll(".cart__item"),n=document.querySelector(".header__cart-sum");console.log("Форма отправлена с товарами:"),i.forEach((function(e){console.log(e.title+": "+e.sum+"шт. на сумму "+e.price*e.sum+" ₽"),t+=e.sum*e.price})),console.log("Итог: "+t+" ₽"),a.forEach((function(e){e.remove()}));var r=document.createElement("p");r.textContent="Корзина пуста",r.classList.add("cart__none"),c.append(r),n.textContent=0,s.textContent="0 ₽",sessionStorage.removeItem("cart")}))}